<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>DVWA Security Assessment Dashboard – WebScanPro</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #222641 0, #101322 40%, #050612 100%);
            color: #f5f6ff;
        }
        .shell {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px 20px 40px 20px;
        }
        .card {
            background: rgba(15, 19, 38, 0.96);
            border-radius: 16px;
            padding: 16px 18px;
            box-shadow: 0 18px 40px rgba(0,0,0,0.55);
            margin-bottom: 18px;
            border: 1px solid rgba(121, 134, 203, 0.25);
        }
        .title-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            flex-wrap: wrap;
        }
        h1 {
            margin: 0;
            font-size: 24px;
        }
        .subtitle {
            margin: 4px 0 0 0;
            font-size: 12px;
            color: #cfd2ff;
        }
        .pill {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 999px;
            border: 1px solid #3c3f6b;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: #cfd2ff;
            background: rgba(32, 39, 78, 0.7);
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
            gap: 14px;
            margin-top: 14px;
        }
        .summary-item h3 {
            margin: 0 0 4px 0;
            font-size: 13px;
            color: #cfd2ff;
        }
        .summary-item p {
            margin: 0;
            font-size: 13px;
        }
        .summary-item strong {
            font-size: 20px;
        }
        .charts-row {
            display: grid;
            grid-template-columns: minmax(260px, 1.1fr) minmax(260px, 1.3fr);
            gap: 16px;
        }
        @media (max-width: 900px) {
            .charts-row {
                grid-template-columns: 1fr;
            }
        }
        .chart-box h3 {
            margin-top: 0;
            font-size: 14px;
            color: #dde0ff;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            margin-top: 10px;
        }
        thead tr {
            background: #262b46;
        }
        th, td {
            border: 1px solid #323757;
            padding: 6px 8px;
            vertical-align: top;
        }
        tbody tr:nth-child(even) {
            background: #191d31;
        }
        tbody tr:nth-child(odd) {
            background: #131728;
        }
        .tiny {
            font-size: 11px;
            color: #d0d2ff;
        }
        .severity-chip {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 999px;
            font-size: 11px;
            margin-right: 4px;
            border: 1px solid #3b3f68;
        }
        .sev-High {
            background: rgba(244, 67, 54, 0.18);
            color: #ff8a80;
            border-color: rgba(244, 67, 54, 0.7);
        }
        .sev-Medium {
            background: rgba(255, 167, 38, 0.18);
            color: #ffcc80;
            border-color: rgba(255, 167, 38, 0.7);
        }
        .sev-Low {
            background: rgba(76, 175, 80, 0.18);
            color: #a5d6a7;
            border-color: rgba(76, 175, 80, 0.7);
        }
    </style>
</head>
<body>
<div class="shell">
    <div class="card">
        <div class="title-row">
            <div>
                <h1>DVWA Security Assessment Dashboard</h1>
                <p class="subtitle">
                    Consolidated findings from WebScanPro modules (authentication, brute-force, access control).
                    Duplicate attempts are merged so you see each issue once, with clear severity and category.
                </p>
            </div>
            <div>
                <span class="pill">Target: http://localhost:8080</span><br/>
                <span class="pill" style="margin-top:6px; background: rgba(233, 30, 99, 0.18); border-color: rgba(233, 30, 99, 0.6);">
                    Auto-generated report
                </span>
            </div>
        </div>

        <div class="summary-grid">
            <div class="summary-item">
                <h3>Total Issues</h3>
                <p><strong>5</strong> consolidated vulnerabilities</p>
            </div>
            <div class="summary-item">
                <h3>Severity Breakdown</h3>
                <p>High: 4 (80%), Medium: 1 (20%)</p>
            </div>
            <div class="summary-item">
                <h3>Categories Observed</h3>
                <p>Auth & Session Management Issue, Password Policy Weakness, Login Brute-force Exposure</p>
            </div>
            <div class="summary-item">
                <h3>Approx. Risk Score</h3>
                <p><strong>14</strong> (High=3, Medium=2, Low=1)</p>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="charts-row">
            <div class="chart-box">
                <h3>Distribution by Severity</h3>
                <canvas id="severityChart" width="320" height="240"></canvas>
            </div>
            <div class="chart-box">
                <h3>Distribution by Category</h3>
                <canvas id="typeChart" width="320" height="240"></canvas>
            </div>
        </div>
    </div>

    <div class="card">
        <h2 style="margin:0 0 8px 0; font-size:18px;">Detailed Findings</h2>
        <p class="tiny">
            Each row below represents one consolidated issue. For example, multiple successful brute-force passwords
            for the same account are collapsed into a single “Login Brute-force Exposure” finding.
        </p>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Category</th>
                    <th>Affected Endpoint</th>
                    <th>Severity</th>
                    <th>Evidence / Notes</th>
                    <th>Suggested Mitigation</th>
                </tr>
            </thead>
            <tbody>
    
                <tr>
                    <td>1</td>
                    <td>Auth & Session Management Issue</td>
                    <td>http://localhost:8080/login.php</td>
                    <td><span class="severity-chip sev-Medium">Medium</span></td>
                    <td class="tiny">Test=cookie_analysis, Evidence=missing_HttpOnly;missing_Secure;missing_SameSite;low_entropy_session_id, Notes=, User=, Cookie=PHPSESSID (path=/, security=low)</td>
                    <td class="tiny">Review login, logout and session handling logic. Avoid exposing session IDs in URLs or client-side scripts and make sure sessions are invalidated on logout or timeout.</td>
                </tr>
        
                <tr>
                    <td>2</td>
                    <td>Password Policy Weakness</td>
                    <td>http://localhost:8080/login.php</td>
                    <td><span class="severity-chip sev-High">High</span></td>
                    <td class="tiny">Test=weak_credential, Evidence=login_success, Notes=Login appeared successful, User=admin, Cookie= ()</td>
                    <td class="tiny">Replace default or guessable passwords with strong password rules. Force users to change any shipped/default credentials at first login and block their reuse. Introduce account lockout or additional verification after several failed attempts.</td>
                </tr>
        
                <tr>
                    <td>3</td>
                    <td>Password Policy Weakness</td>
                    <td>http://localhost:8080/login.php</td>
                    <td><span class="severity-chip sev-High">High</span></td>
                    <td class="tiny">Test=weak_credential, Evidence=login_success, Notes=Login appeared successful, User=root, Cookie= ()</td>
                    <td class="tiny">Replace default or guessable passwords with strong password rules. Force users to change any shipped/default credentials at first login and block their reuse. Introduce account lockout or additional verification after several failed attempts.</td>
                </tr>
        
                <tr>
                    <td>4</td>
                    <td>Password Policy Weakness</td>
                    <td>http://localhost:8080/login.php</td>
                    <td><span class="severity-chip sev-High">High</span></td>
                    <td class="tiny">Test=weak_credential, Evidence=login_success, Notes=Login appeared successful, User=user, Cookie= ()</td>
                    <td class="tiny">Replace default or guessable passwords with strong password rules. Force users to change any shipped/default credentials at first login and block their reuse. Introduce account lockout or additional verification after several failed attempts.</td>
                </tr>
        
                <tr>
                    <td>5</td>
                    <td>Login Brute-force Exposure</td>
                    <td>http://localhost:8080/login.php</td>
                    <td><span class="severity-chip sev-High">High</span></td>
                    <td class="tiny">Test=bruteforce, Evidence=login_success, Notes=Bruteforce success, User=admin, Cookie= ()</td>
                    <td class="tiny">Throttle repeated login attempts using rate limiting or CAPTCHAs. Lock or temporarily suspend accounts after too many failures and alert admins about suspicious activity.</td>
                </tr>
        
            </tbody>
        </table>
    </div>
</div>

<script>
    // Severity chart (doughnut)
    const sevCtx = document.getElementById('severityChart').getContext('2d');
    new Chart(sevCtx, {
        type: 'doughnut',
        data: {
            labels: ["High", "Medium"],
            datasets: [{
                data: [4, 1],
                backgroundColor: [
                    'rgba(244, 67, 54, 0.7)',   // High
                    'rgba(255, 167, 38, 0.7)',  // Medium
                    'rgba(76, 175, 80, 0.7)'    // Low
                ].slice(0, 2),
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: { boxWidth: 14 }
                },
                tooltip: {
                    callbacks: {
                        label: function(ctx) {
                            const count = ctx.parsed;
                            const total = ctx.dataset.data.reduce((a, b) => a + b, 0);
                            const pct = total ? Math.round((count / total) * 100) : 0;
                            return ctx.label + ': ' + count + ' (' + pct + '%)';
                        }
                    }
                }
            },
            cutout: '55%'
        }
    });

    // Category chart (horizontal bar)
    const typeCtx = document.getElementById('typeChart').getContext('2d');
    new Chart(typeCtx, {
        type: 'bar',
        data: {
            labels: ["Auth & Session Management Issue", "Password Policy Weakness", "Login Brute-force Exposure"],
            datasets: [{
                data: [1, 3, 1],
                borderWidth: 1
            }]
        },
        options: {
            indexAxis: 'y',
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: function(ctx) {
                            return ctx.raw + ' issue(s)';
                        }
                    }
                }
            },
            scales: {
                x: {
                    beginAtZero: true,
                    ticks: { precision: 0 }
                }
            }
        }
    });
</script>
</body>
</html>
